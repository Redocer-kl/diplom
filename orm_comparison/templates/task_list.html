{% extends "base.html" %}

{% block content %}
<h2>Your Tasks</h2>
<a href="{% url 'add_task' %}" class="btn btn-success mb-3">Add New Task</a>
<ul class="list-group">
    {% for task in tasks %}
    <li class="list-group-item {% if task.is_completed %}list-group-item-success{% endif %}">
        <div class="d-flex justify-content-between align-items-center">
            <div>
                <h5>{{ task.title }}</h5>
                <p class="mb-1">{{ task.description }}</p>
                <small class="text-muted">{{ task.created_at|date:"d.m.Y H:i" }}</small>
            </div>
            <div class="btn-group">
                <form action="{% url 'toggle_task' task.id %}" method="post" class="d-inline">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm {% if task.is_completed %}btn-outline-secondary{% else %}btn-outline-success{% endif %}">
                        {% if task.is_completed %}Undo{% else %}Complete{% endif %}
                    </button>
                </form>
                <form action="{% url 'delete_task' task.id %}" method="post" class="d-inline">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-sm btn-outline-danger">Delete</button>
                </form>
            </div>
        </div>
    </li>
    {% empty %}
    <li class="list-group-item">No tasks yet.</li>
    {% endfor %}
</ul>
{% endblock %}